version: "3.8"

services:
  duckdns:
    image: linuxserver/duckdns
    container_name: duckdns
    environment:
      - SUBDOMAINS=${DUCKDNS_SUBDOMAIN}
      - TOKEN=${DUCKDNS_TOKEN}
      - LOG_FILE=false
    restart: unless-stopped

  jacktrip:
    image: jacktrip/jacktrip
    container_name: jacktrip-server
    network_mode: host  # JackTrip needs direct network access
    shm_size: 128m      # Required for JACK shared memory
    privileged: true    # Required for realtime threads
    restart: unless-stopped
    environment:
      # JACK server settings
      - SAMPLE_RATE=48000        # Sample rate (Hz)
      - BUFFER_SIZE=128          # Frames per period (buffer size)
      - JACK_OPTS=-d dummy       # Use dummy backend, no audio device needed

      # JackTrip server settings
      - JACKTRIP_OPTS=-S --hubpatch 4 --numchannels 2 --bitres 16 --udpbaseport 61000
